{"version":3,"file":"commonHelpers.js","sources":["../src/js/API_script.js","../src/js/izitoast.js","../src/js/gallery.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '40477492-fb7a942987769cd06fc4fed72';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const PER_PAGE = 40;\n\nexport const api = axios.create({\n  baseURL: BASE_URL,\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  },\n});\n\nexport const fetchImages = async (query, page = 1, limit = 20) => {\n  const response = await api.get('', {\n    params: {\n      q: query,\n      page,\n      per_page: limit,\n    },\n  });\n\n  const { hits, totalHits } = response.data;\n  return { list: hits, total: totalHits };\n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  timeout: 4000,\n  position: 'topRight',\n  maxWidth: '400px',\n  titleSize: '16px',\n  messageSize: '16px',\n});\n\nconst warning = message => {\n  iziToast.warning({\n    title: 'Attention!',\n    message,\n  });\n};\n\nconst error = message => {\n  iziToast.error({\n    title: 'Error!',\n    message,\n  });\n};\n\nconst success = message => {\n  iziToast.success({\n    title: 'Success!',\n    message,\n  });\n};\n\nexport const toast = {\n  emptyList: message => {\n    warning(\n      message ||\n        'We have not found any images matching your request. Please try again.'\n    );\n  },\n\n  endCollection: message => {\n    warning(\n      message || \"That is all for now. Would you like to search more?\"\n    );\n  },\n\n  fetchError: message => {\n    error(message || 'Sorry. Something went wrong.');\n  },\n\n  foundTotal: total => {\n    success(`Hooray! We found ${total} images.`);\n  },\n};","import { fetchImages } from \"./API_script\";\nimport SimpleLightBox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { PER_PAGE } from \"./API_script\";\nimport { toast } from \"./izitoast\";\n\nfunction createGallery(\n  render,\n  {\n    initialPage,\n    initialQuery,\n    initialList,\n    limit,\n    loader,\n    smoothScroll,\n    loadMore,\n  }\n) {\n  let page = initialPage || 1;\n  let query = initialQuery || '';\n  let list = initialList || [];\n  let total = null;\n\n  async function fetchData() {\n    if (!query) return;\n    try {\n      loader && loader.show();\n      loadMore.hide();\n\n      const data = await fetchImages(query, page, limit);\n\n      list.push(...data.list);\n      total = data.total;\n\n      const isEndCollection = limit * page >= total;\n      const isCollectionEmpty = data.list.length === 0;\n\n      if (isCollectionEmpty) {\n        toast.emptyList();\n      } else if (isEndCollection) {\n        toast.endCollection();\n      } else if (page === 1) {\n        toast.foundTotal(total);\n      }\n\n      render(list);\n\n      if (!isEndCollection) loadMore.show();\n\n      smoothScroll && page !== 1 && !isCollectionEmpty && smoothScroll();\n    } catch (error) {\n      console.log('err', error);\n      toast.fetchError();\n    } finally {\n      loader && loader.hide();\n    }\n  }\n\n  return {\n    getPage() {\n      return page;\n    },\n\n    increasePage() {\n      page += 1;\n      fetchData();\n    },\n\n    resetPage() {\n      page = 1;\n    },\n\n    setQuery(newQuery) {\n      this.resetPage();\n      this.clearList();\n      query = newQuery;\n      fetchData();\n    },\n\n    clearList() {\n      list = [];\n    },\n  };\n}\n\nfunction createGAlleryMarkup(list) {\n    return list.map(createGalleryMarkup).join('');\n}\n\n        function createGalleryMarkup({\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n          webformatURL,\n        }) {\n          return `\n          <div class=\"photo-card\">\n            <a class=\"photo-card__link\" href=\"${largeImageURL}\">\n                <img class=\"photo-card__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            </a>    \n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b><span>${likes}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b><span>${views}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b><span>${comments}</span>\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b><span>${downloads}</span>\n                </p>\n            </div>\n        </div>`;\n        }\n\n\nconst form = document.querySelector('.search');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loaderRef = document.querySelector('.loader');\n\nconst lightbox = new SimpleLightBox('.gallery a', {\n  showCounter: false,\n});\n\nconst galleryInstance = createGallery(render, {\n  limit: PER_PAGE,\n  loader: createHideable(loaderRef),\n  smoothScroll,\n  loadMore: createHideable(loadMoreBtn),\n});\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  const query = e.target.elements.searchQuery.value.trim();\n\n  galleryInstance.setQuery(query);\n});\n\nloadMoreBtn.addEventListener('click', () => {\n  galleryInstance.increasePage();\n});\n\nfunction render(data) {\n  const markup = createGAlleryMarkup(data);\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2.3,\n    behavior: 'smooth',\n  });\n}\n\nfunction createHideable(instance) {\n  return {\n    show() {\n      instance.classList.add('visible');\n    },\n    hide() {\n      instance.classList.remove('visible');\n    },\n  };\n}"],"names":["API_KEY","BASE_URL","PER_PAGE","api","axios","fetchImages","query","page","limit","response","hits","totalHits","iziToast","warning","message","error","success","toast","total","createGallery","render","initialPage","initialQuery","initialList","loader","smoothScroll","loadMore","list","fetchData","data","isEndCollection","isCollectionEmpty","newQuery","createGAlleryMarkup","createGalleryMarkup","largeImageURL","tags","likes","views","comments","downloads","webformatURL","form","gallery","loadMoreBtn","loaderRef","lightbox","SimpleLightBox","galleryInstance","createHideable","markup","cardHeight","instance"],"mappings":"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"}