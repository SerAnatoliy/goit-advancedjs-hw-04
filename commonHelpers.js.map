{"version":3,"file":"commonHelpers.js","sources":["../src/js/API_script.js","../src/js/izitoast.js","../src/js/gallery.js"],"sourcesContent":["import axios from \"axios\";\n\n\nconst API_KEY = '41007167-88dba9d0c39a2133a3a0b3dca';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const PER_PAGE = 40\n\nconst request = axios.create({\n    baseURL: BASE_URL,\n    params: {\n        key: API_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n    },\n});\n\nexport const fetchImages = async (query, page = 1, limit = 20) => {\n    const response = await request.get('', {\n        params: {\n            q: query,\n            page,\n            per_page: limit,\n        },\n\n    })\n\n    const { hits, totalHits } = response.data\n    return {\n        list: hits,\n        total: totalHits,\n    }\n}\n","import iziToast from \"izitoast\";\nimport 'izitoast/dist/css/iziToast.min.css'\n\n\niziToast.settings({\n    timeout: 3000,\n    position: 'center',\n    maxWidth: '400px',\n    titleSize: '16px',\n    messageSize: '14px',\n})\n\nconst warning = message => {\n    iziToast.warning({\n        title: 'Attention!',\n        message,\n    })\n}\n\nconst error = message => {\n    iziToast.error({\n        title: 'An error have ocrred!',\n        message,\n    })\n}\n\nconst success = message => {\n    iziToast.success({\n        title: 'Success!',\n        message,\n    })\n}\n\nexport const toast = {\n    emptylist: message => {\n        warning(\n            message || 'We could not found any images matching your search request'\n        )\n    },\n    endCollection: message => {\n        warning(\n            message || 'That is all for now. You have reached the end of the result list'\n        )\n    },\n    fetchError: message => {\n        error(message || 'Error have occured. Please try again later')\n    },\n    foundTotal: message => {\n        success(message || `We have found ${total} images`)\n    },\n}","import { fetchImages } from \"./API_script\";\nimport SimpleLightBox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { PER_PAGE } from \"./API_script\";\nimport { toast } from \"./izitoast\";\n\nfunction createGallery(\n    render,\n    {\n        initialPage,\n        initialQuery,\n        initialList,\n        limit,\n        loader,\n        smoothScroll,\n        loadMore,\n    }\n) {\n    let page = initialPage || 1\n    let query = initialQuery || ''\n    let list = initialList || []\n    let total = null\n    fetchData()\n    async function fetchData() {\n        if (!query) return\n        try {\n            loader && loader.show()\n            loadMore.hide()\n\n            const data = await fetchImages(query, page, limit)\n\n            console.log('data', data)\n\n            list.push(...data.list)\n            total = data.total\n\n            const isEndCollection = limit * page >= total\n            const isCollectionEmpty = data.list.length === 0\n\n            if (isCollectionEmpty) {\n                toast.emptylist()\n            }\n            else if (isEndCollection) {\n                toast.endCollection()\n            }\n            else if (page === 1) {\n                toast.foundTotal(total)\n            }\n\n            render(list)\n\n            if (!isEndCollection) loadMore.show()\n\n            smoothScroll && page !== 1 && isCollectionEmpty && smoothScroll()\n        }\n        catch (error) {\n            console.log('error', error)\n            toast.fetchError()\n        }\n        finally {\n            loader && loader.hide()\n        }\n    }\n    return {\n        getPage() {\n            return page\n        },\n        increasePage() {\n            page += 1\n        },\n        resetPage() {\n            page = 1\n        },\n        setQuery(newQuery) {\n            this.resetPage();\n            this.clearList();\n            query = newQuery\n            fetchData()\n        },\n        clearList() {\n            list = []\n        }\n    }\n}\n\nfunction createGAlleryMarkup(list) {\n    return list.map(createGalleryMarkup).join('');\n}\n\nfunction createGalleryMarkup({\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n    webformatURL,\n}) {\n    return `\n  <div class=\"photo-card\">\n    <a class=\"photo-card__link\" href=\"${largeImageURL}\">\n        <img class=\"photo-card__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    </a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b><span>${likes}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Views</b><span>${views}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b><span>${comments}</span>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b><span>${downloads}</span>\n        </p>\n    </div>\n</div>`;\n}\nconst form = document.querySelector('.search');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loaderRef = document.querySelector('.loader');\n\nconst lightbox = new SimpleLightBox('.gallery', {\n    showCounter: false,\n});\n\nconst galleryInstance = createGallery(render, {\n    limit: PER_PAGE,\n    loader: createHideable(loaderRef),\n    smoothScroll,\n    loadMore: createHideable(loadMoreBtn),\n});\n\nform.addEventListener('submit', e => {\n    e.preventDefault();\n    const query = e.target.elements.searchQuery.value.trim();\n\n    galleryInstance.setQuery(query);\n});\n\nloadMoreBtn.addEventListener('click', () => {\n    galleryInstance.increasePage();\n});\n\n\nfunction render(data) {\n    const markup = createGAlleryMarkup(data);\n    gallery.innerHTML = '';\n    gallery.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\n\nfunction smoothScroll() {\n    const { height: cardHeight } = document\n        .querySelector('.gallery')\n        .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2.3,\n        behavior: 'smooth',\n    });\n}\n\nfunction createHideable(instance) {\n    return {\n        show() {\n            instance.classList.add('visible');\n        },\n        hide() {\n            instance.classList.remove('visible');\n        },\n    };\n}"],"names":["API_KEY","BASE_URL","PER_PAGE","request","axios","fetchImages","query","page","limit","response","hits","totalHits","iziToast","warning","message","error","success","toast","createGallery","render","initialPage","initialQuery","initialList","loader","smoothScroll","loadMore","list","total","fetchData","data","isEndCollection","isCollectionEmpty","newQuery","createGAlleryMarkup","createGalleryMarkup","largeImageURL","tags","likes","views","comments","downloads","webformatURL","form","gallery","loadMoreBtn","loaderRef","lightbox","SimpleLightBox","galleryInstance","createHideable","markup","cardHeight","instance"],"mappings":"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"}